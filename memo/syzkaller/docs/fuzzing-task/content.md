# Fuzzing Task

[SyzVegas](https://www.usenix.org/conference/usenixsecurity21/presentation/wang-daimeng) を参考に

<br/>

- syzkaller のファジングの3つのタスク
  1. 生成 (Generation)
  2. 変異 (Mutation)
  3. トリアージ (Triage)

## 1. 生成

- 手作業で作られたシステムコールのテンプレートからプログラム (システムコールとその引数の列) を作成
  - テンプレートには各システムコールの型やシステムコール間の依存関係が含まれる

## 2. 変異

- コーパスからシードをランダムに選び, 変異させる
  - [詳細](../mutation-mechanism/)

## 3. トリアージ

- syzkaller は新しいカバレッジを生成したプログラムをすぐにコーパスに保存せず, 以下の操作を行う

#### 3.1. 検証 (Verification)

- 新しいカバレッジが確実に達成できるかどうか実行して確かめる
  - カーネルのグローバルな状態に影響を受けないか?
  - 実行の非決定性の影響を受けないか?
  - 別スレッド/プロセスの影響を受けないか?

#### 3.1. 最小化 (Minimization)

- 検証が成功したら, 新しいカバレッジを維持しながら, いくつかのシステムコールを削除・引数を短くする
- その後テストコーパスに追加する

## ファジングタスクの優先順位

1. トリアージは生成・変異よりも優先される
2. トリアージタスクがない場合, シードコーパスに追加されたばかりのプログラムを変異させることが優先
   
   新しいシードを一定回数変異させる (これらの変異はスマッシュ (Smash) と呼ばれる)

3. トリアージやスマッシュがない場合, 生成・変異を行う (5:95 の割合)