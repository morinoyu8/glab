# PrIntFuzz: fuzzing Linux drivers via automated virtual device simulation [ISSTA'22]

## Abstract

- Linux ドライバはカーネルのコアと同じアドレス空間と特権を共有しているが, コードベースと攻撃対象は遥かに大きい
- ドライバは十分にテストされておらず, セキュリティが弱い
- ハードウェアデバイスがないと, 既存のファジングはドライバコードの大部分をカバーすることができない
  - 初期化コードや割り込みハンドラなど

<br/>

- 本論文では probing や 割り込みハンドラを含む, 見過ごされているドライバコードをテストできるファジングフレームワークの PrIntFuzz を紹介
- PrIntFuzz は最初に, 静的解析によって, ドライバから知識を抽出
  - inter-procedural
  - field-sensitive
  - path-sensitive
  - flow-sensitive
- 次にその情報を利用して, シミュレータを構築し, 以下をサポート
  - デバイスプロービング
  - ハードウェア割り込みエミュレーション
  - デバイス I/O インターセプト
- PrIntFuzz は多次元ファジング戦略を適用し, 見落とされたコードを探索する

<br/>

- 以下のデバイスのシミュレーションに成功
  - 311個の仮想PCI
    - PCI (Peripheral Component Interconnect) : PC のメインボードに接続されるインターフェース規格
    - CPU, メモリ以外の周辺機器 (ビデオカード (GPU), サウンドカード, ネットワークカード)
      - これらのカードで, 映像出力, 音声入出力, ネットワークへの物理的接続ができる
  - 472個の仮想I2C
    - I2C (Inter-Integrated Circuit) : 短距離で低速なインターフェース
    - センサ, LCD など (ラズパイでつなげたものか?)
  - 472個の仮想USB
    - USB (Universal Serial Bus) : USB インターフェースを使用して接続する周辺機器
       - キーボード, マウス, プリンタ, 外付けハードディスク
- これらに対応するバグを 150個発見
- Linux5.10-rc6 では 99個のバグを発見したが, 他の最先端のファザーは50個しか発見できなかった
- PrIntFuzz は 11,968 個の基本ブロックをカバー
  - その他のファザーは 2,353個の基本ブロックしかカバーしていない